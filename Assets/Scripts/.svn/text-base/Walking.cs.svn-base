using UnityEngine;
using System.Collections;

public class Walking : MonoBehaviour {

	public GameObject m_Waypoint;
	public GameObject m_splinePath;
	public Vector3 m_footOffset;
	public float	m_walkSpeed = 1.4f;
	public float m_bioMontrics = 0.0001f;
	private Vector3 ground;
	
	// Use this for initialization
	void Start () {
		iTween.Init(gameObject);
		RenderSettings.fogDensity=m_bioMontrics;
	}

	void Awake() {
		Vector3[] pathArray = iTweenPath.GetPath(m_splinePath.name);
		iTween.MoveTo(gameObject,iTween.Hash("name", "Walk", "path", pathArray, "speed", m_walkSpeed, "easetype", iTween.EaseType.linear, "orienttopath", true, "lookahead", 0.01, "delay", 5, "looptype",iTween.LoopType.none));
		print("Path length:" + iTween.PathLength(pathArray));
		for(int x=0; x<pathArray.Length; x++) {
			RaycastHit hit;
			Physics.Raycast(pathArray[x], Vector3.down, out hit, 100f);
			print("Path Height " + (x + 1.0f)  + "=" + (hit.distance));
			
		}
		
	}
	
	void OnGUI() {
		if(Event.current.type==EventType.ScrollWheel) {

			Vector2 dB=Event.current.delta;
			string readout = "";
			if(Mathf.Abs(dB.x)>1.0f) {
				m_bioMontrics-=( dB.x * (m_bioMontrics*0.1f + 0.00001f));
				if(m_bioMontrics<0f) m_bioMontrics=0f;
				RenderSettings.fogDensity=m_bioMontrics;
				readout = "Fog Density:" + m_bioMontrics;
			}

			if(Mathf.Abs(dB.y)>1.0f) {
				m_walkSpeed+=(Event.current.delta.y*0.25f);
				readout += "Speed:" + m_walkSpeed;
			}
			
			iTween tween = gameObject.GetComponent("iTween") as iTween;
			if(tween != null) tween.setPathSpeed(m_walkSpeed);

			print(readout);
		}
	}	
}
